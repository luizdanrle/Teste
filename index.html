<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Relatório Técnico de Manutenção - TechMaintain</title>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  
  <!-- Configuração do Tailwind -->
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'sans-serif'],
            mono: ['JetBrains Mono', 'monospace'],
          },
          colors: {
            tech: {
              50: '#f0f9ff',
              100: '#e0f2fe',
              500: '#0ea5e9',
              600: '#0284c7',
              700: '#0369a1',
              900: '#0c4a6e',
            }
          }
        }
      }
    }
  </script>

  <!-- React & ReactDOM (CDN Estável) -->
  <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  
  <!-- Babel (Para converter JSX no navegador) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <!-- html2canvas (Para tirar print do relatório) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <style>
    /* Estilos personalizados de rolagem */
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: #f1f5f9; }
    .dark ::-webkit-scrollbar-track { background: #0f172a; }
    ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
    .dark ::-webkit-scrollbar-thumb { background: #334155; }
    ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    
    body { background-color: #f8fafc; color: #1e293b; transition: background-color 0.3s, color 0.3s; }
    .dark body { background-color: #020617; color: #f8fafc; }
    
    @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
    .animate-fade-in { animation: fade-in 0.3s ease-out; }
    
    /* Ocultar elementos na impressão/screenshot se necessário */
    .no-print { }
  </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "lucide-react": "https://aistudiocdn.com/lucide-react@^0.555.0",
    "recharts": "https://aistudiocdn.com/recharts@^3.5.1",
    "html2canvas": "https://aistudiocdn.com/html2canvas@^1.4.1",
    "vite": "https://aistudiocdn.com/vite@^7.2.4",
    "@vitejs/plugin-react": "https://aistudiocdn.com/@vitejs/plugin-react@^5.1.1"
  }
}
</script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo, useRef } = React;

    // --- ÍCONES SVG NATIVOS (Para evitar erros de biblioteca externa) ---
    const IconWrapper = ({ children, className, size = 20, ...props }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>
        {children}
      </svg>
    );

    const Icons = {
      Award: (p) => <IconWrapper {...p}><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></IconWrapper>,
      Calendar: (p) => <IconWrapper {...p}><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></IconWrapper>,
      MapPin: (p) => <IconWrapper {...p}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></IconWrapper>,
      Download: (p) => <IconWrapper {...p}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></IconWrapper>,
      QrCode: (p) => <IconWrapper {...p}><rect width="5" height="5" x="3" y="3" rx="1"/><rect width="5" height="5" x="16" y="3" rx="1"/><rect width="5" height="5" x="3" y="16" rx="1"/><path d="M21 16h-3a2 2 0 0 0-2 2v3"/><path d="M21 21v.01"/><path d="M12 7v3a2 2 0 0 1-2 2H7"/><path d="M3 12h.01"/><path d="M12 3h.01"/><path d="M12 16v.01"/><path d="M16 12h1"/><path d="M21 12v.01"/><path d="M12 21v-1"/></IconWrapper>,
      User: (p) => <IconWrapper {...p}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></IconWrapper>,
      Mail: (p) => <IconWrapper {...p}><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></IconWrapper>,
      Smartphone: (p) => <IconWrapper {...p}><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></IconWrapper>,
      ExternalLink: (p) => <IconWrapper {...p}><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></IconWrapper>,
      Cpu: (p) => <IconWrapper {...p}><rect width="16" height="16" x="4" y="4" rx="2"/><rect width="6" height="6" x="9" y="9" rx="1"/><path d="M15 2v2"/><path d="M15 20v2"/><path d="M2 15h2"/><path d="M2 9h2"/><path d="M20 15h2"/><path d="M20 9h2"/><path d="M9 2v2"/><path d="M9 20v2"/></IconWrapper>,
      Wrench: (p) => <IconWrapper {...p}><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></IconWrapper>,
      AlertTriangle: (p) => <IconWrapper {...p}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/></IconWrapper>,
      CheckCircle2: (p) => <IconWrapper {...p}><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></IconWrapper>,
      Thermometer: (p) => <IconWrapper {...p}><path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/></IconWrapper>,
      ImageIcon: (p) => <IconWrapper {...p}><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></IconWrapper>,
      Shield: (p) => <IconWrapper {...p}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></IconWrapper>,
      ShieldCheck: (p) => <IconWrapper {...p}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/><path d="m9 12 2 2 4-4"/></IconWrapper>,
      AlertCircle: (p) => <IconWrapper {...p}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></IconWrapper>,
      Server: (p) => <IconWrapper {...p}><rect width="20" height="8" x="2" y="2" rx="2" ry="2"/><rect width="20" height="8" x="2" y="14" rx="2" ry="2"/><line x1="6" x2="6.01" y1="6" y2="6"/><line x1="6" x2="6.01" y1="18" y2="18"/></IconWrapper>,
      Activity: (p) => <IconWrapper {...p}><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></IconWrapper>,
      MailCheck: (p) => <IconWrapper {...p}><path d="M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/><path d="m16 19 2 2 4-4"/></IconWrapper>,
      CalendarClock: (p) => <IconWrapper {...p}><path d="M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5"/><path d="M16 2v4"/><path d="M8 2v4"/><path d="M3 10h5"/><path d="M17.5 17.5 16 16.25V14"/><path d="M22 16a6 6 0 1 1-12 0 6 6 0 0 1 12 0Z"/></IconWrapper>,
      Sparkles: (p) => <IconWrapper {...p}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 5H5"/><path d="M19 3v4"/><path d="M15 5h4"/></IconWrapper>,
      Copy: (p) => <IconWrapper {...p}><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></IconWrapper>,
      Send: (p) => <IconWrapper {...p}><line x1="22" x2="11" y1="2" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></IconWrapper>,
      Loader2: (p) => <IconWrapper {...p}><path d="M21 12a9 9 0 1 1-6.219-8.56"/></IconWrapper>,
      X: (p) => <IconWrapper {...p}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></IconWrapper>,
      Check: (p) => <IconWrapper {...p}><polyline points="20 6 9 17 4 12"/></IconWrapper>,
      ZoomIn: (p) => <IconWrapper {...p}><circle cx="11" cy="11" r="8"/><line x1="21" x2="16.65" y1="21" y2="16.65"/><line x1="11" x2="11" y1="8" y2="14"/><line x1="8" x2="14" y1="11" y2="11"/></IconWrapper>,
      ZoomOut: (p) => <IconWrapper {...p}><circle cx="11" cy="11" r="8"/><line x1="21" x2="16.65" y1="21" y2="16.65"/><line x1="8" x2="14" y1="11" y2="11"/></IconWrapper>,
      ChevronLeft: (p) => <IconWrapper {...p}><path d="m15 18-6-6 6-6"/></IconWrapper>,
      ChevronRight: (p) => <IconWrapper {...p}><path d="m9 18 6-6-6-6"/></IconWrapper>,
      Sun: (p) => <IconWrapper {...p}><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41-1.41"/><path d="m19.07 4.93-1.41 1.41"/></IconWrapper>,
      Moon: (p) => <IconWrapper {...p}><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></IconWrapper>,
    };

    // --- DADOS DO RELATÓRIO ---
    const SERVICE_DATE = new Date(2025, 10, 28, 11, 0, 0); // Mês 10 = Novembro
    const WARRANTY_MONTHS = 10;
    
    const serviceInfo = { 
      id: "SRV-2025-11-28-001", 
      date: "28 de Novembro de 2025", 
      location: "Lisboa, Portugal", 
      time: "11:00" 
    };

    const provider = { 
      name: "Luiz Danrley Santos Silva", 
      email: "luizdanrley47@gmail.com", 
      whatsapp: "(+351) 924 789 391", 
      roles: ["Engenheiro de Computação", "Técnico em Automação", "Técnico em Eletrônica"], 
      avatarUrl: "https://drive.google.com/thumbnail?id=1OvXfKTvHNVSvlIvB0lIqf2PGZGTKUTjd&sz=w1000" 
    };
    const client = { name: "José Paulo dos Santos", whatsapp: "+55 38 9212-0436" };
    const device = { 
      brand: "Playstation", model: "PS4 FAT", storage: "1TB", firmware: "9.00", 
      mode: "Desbloqueada Gold Hen", drive: "BD-J LAPSE V1.2 AIO FIX", cables: "HDMI, Força, Controles", adapter: "Entregues em funcionamento" 
    };
    const internalChecklist = [
      { name: "Placa Mãe", status: 'clean' }, { name: "Processador", status: 'clean' },
      { name: "Fonte Interna", status: 'clean' }, { name: "Carcaça", status: 'clean' }, { name: "Cooler", status: 'clean' }
    ];
    const thermalSpecs = { name: "ZF-12 High Performance", conductivity: 12, resistance: 0.003, tempRange: "-160°C / +280°C" };
    const GALLERY_IMAGES = [
      "https://drive.google.com/thumbnail?id=1LwStppZsUb754upgaHA_Hf-n78fLzQIS&sz=w1000",
      "https://drive.google.com/thumbnail?id=1rNTV2hkZtjBt-AbbQ2liXhTgMJlTBBsN&sz=w1000",
      "https://drive.google.com/thumbnail?id=1zhO9pBVPnW_0BgkAh0GjUSfkobKVimmE&sz=w1000",
      "https://drive.google.com/thumbnail?id=19p5iv1puFT_jWrNOU6hcwFGmwVh_C-pH&sz=w1000",
      "https://drive.google.com/thumbnail?id=1qFPlUpZH_VNQNLhfSGVuchQUQlY-C5c7&sz=w1000",
      "https://drive.google.com/thumbnail?id=1KyQf4BQIK-mPHut6Y7T7xmuOjObDO74F&sz=w1000",
      "https://drive.google.com/thumbnail?id=1j3MNd7ZO3EF554Aw-scRk6YbTeSFqnMG&sz=w1000"
    ];
    const REMINDER_EMAILS = ["luizdanrley47@gmail.com", "paulosantos.1996@outlook.com"];

    // --- FUNÇÕES UTILITÁRIAS ---
    const getWhatsAppUrl = (phone) => `https://wa.me/${phone.replace(/\D/g, '')}`;
    const getCorsProxyUrl = (url) => `https://wsrv.nl/?url=${encodeURIComponent(url)}`;

    // --- COMPONENTES ---
    const Section = ({ title, icon, children, className = "" }) => (
      <section className={`bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-800 overflow-hidden transition-colors ${className}`}>
        <div className="px-6 py-4 border-b border-slate-50 dark:border-slate-800 flex items-center gap-3 bg-slate-50/50 dark:bg-slate-800/50">
          {icon && <span className="text-tech-600 dark:text-tech-400">{icon}</span>}
          <h2 className="text-lg font-semibold text-slate-800 dark:text-slate-100 tracking-tight">{title}</h2>
        </div>
        <div className="p-6">{children}</div>
      </section>
    );

    const InfoRow = ({ label, value, mono }) => (
      <div className="flex flex-col sm:flex-row sm:justify-between py-2.5 border-b border-slate-50 dark:border-slate-800 last:border-0 hover:bg-slate-50/50 dark:hover:bg-slate-800/50 transition-colors px-2 rounded">
        <span className="text-sm font-medium text-slate-500 dark:text-slate-400">{label}</span>
        <span className={`text-sm text-slate-800 dark:text-slate-200 font-semibold text-right ${mono ? 'font-mono' : ''}`}>{value}</span>
      </div>
    );

    const StatusBadge = ({ status }) => {
      if (status === 'clean') return <span className="inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-100 dark:bg-emerald-900/30 text-emerald-800 dark:text-emerald-300 border border-transparent dark:border-emerald-800/50"><Icons.CheckCircle2 size={12}/> Limpo</span>;
      return <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 dark:bg-slate-800 text-gray-800 dark:text-slate-300">{status}</span>;
    };

    const ThermalChart = ({ conductivity }) => {
      const maxVal = 14; 
      const items = [
        { label: 'Padrão (Cinza)', value: 1.5, color: 'bg-slate-300 dark:bg-slate-600' },
        { label: 'Prata (Comum)', value: 5.0, color: 'bg-slate-400 dark:bg-slate-500' },
        { label: 'Alta Perf. (ZF-12)', value: conductivity, color: 'bg-tech-600 dark:bg-tech-500' },
      ];

      return (
        <div className="mt-6 space-y-3">
          <p className="text-xs font-bold text-slate-400 dark:text-slate-500 uppercase mb-2 text-center">Comparativo de Condutividade (W/mK)</p>
          {items.map((item, idx) => (
            <div key={idx} className="flex items-center gap-3">
              <div className="w-24 text-right text-xs font-medium text-slate-500 dark:text-slate-400">{item.label}</div>
              <div className="flex-1 h-6 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden relative">
                <div 
                  className={`h-full ${item.color} rounded-full flex items-center justify-end pr-2 transition-all duration-1000`} 
                  style={{ width: `${(item.value / maxVal) * 100}%` }}
                >
                  <span className="text-[10px] font-bold text-white drop-shadow-sm">{item.value}</span>
                </div>
              </div>
            </div>
          ))}
        </div>
      );
    };

    const WarrantyCard = ({ serviceDate, durationMonths }) => {
      const [daysRemaining, setDaysRemaining] = useState(0);
      const [expirationDate, setExpirationDate] = useState(new Date());
      const [status, setStatus] = useState('active');
      const [progress, setProgress] = useState(0);

      useEffect(() => {
        // Cálculo de datas preciso (normalizando horas)
        const start = new Date(serviceDate);
        start.setHours(0,0,0,0);
        
        const expDate = new Date(start);
        expDate.setMonth(expDate.getMonth() + durationMonths);
        expDate.setHours(23,59,59,999);
        
        setExpirationDate(expDate);

        const calculateTimeLeft = () => {
          const now = new Date();
          const todayNormal = new Date(now);
          todayNormal.setHours(0,0,0,0);
          
          const totalDuration = expDate.getTime() - start.getTime();
          const timeLeft = expDate.getTime() - now.getTime();
          
          const days = Math.ceil(timeLeft / (1000 * 60 * 60 * 24));
          setDaysRemaining(days);

          let progressPercent = 0;
          if (timeLeft <= 0) progressPercent = 100;
          else {
            const timePassed = totalDuration - timeLeft;
            progressPercent = (timePassed / totalDuration) * 100;
          }
          
          setProgress(Math.max(0, Math.min(100, progressPercent)));

          if (days <= 0) setStatus('expired');
          else if (days <= 30) setStatus('warning');
          else setStatus('active');
        };

        calculateTimeLeft();
        const timer = setInterval(calculateTimeLeft, 60000); 
        return () => clearInterval(timer);
      }, [serviceDate, durationMonths]);

      const styles = {
        expired: { 
          bg: 'bg-red-50 border-red-200 dark:bg-red-900/10 dark:border-red-900/30', 
          text: 'text-red-700 dark:text-red-400', 
          icon: <Icons.AlertCircle size={28} className="text-red-600 dark:text-red-500"/>, 
          title: 'Garantia Expirada', 
          bar: 'bg-red-500' 
        },
        warning: { 
          bg: 'bg-amber-50 border-amber-200 dark:bg-amber-900/10 dark:border-amber-900/30', 
          text: 'text-amber-700 dark:text-amber-400', 
          icon: <Icons.AlertTriangle size={28} className="text-amber-600 dark:text-amber-500"/>, 
          title: 'Vencendo', 
          bar: 'bg-amber-500' 
        },
        active: { 
          bg: 'bg-emerald-50/50 border-emerald-100 dark:bg-emerald-900/10 dark:border-emerald-900/30', 
          text: 'text-emerald-700 dark:text-emerald-400', 
          icon: <Icons.ShieldCheck size={28} className="text-emerald-600 dark:text-emerald-500"/>, 
          title: 'Garantia Ativa', 
          bar: 'bg-tech-500' 
        }
      }[status];

      return (
        <div className={`rounded-xl p-6 border ${styles.bg} shadow-sm relative overflow-hidden transition-all`}>
          <div className="flex flex-col md:flex-row items-center justify-between gap-6 relative z-10">
            <div className="flex items-center gap-4 w-full md:w-auto">
              <div className="p-3 rounded-2xl bg-white dark:bg-slate-800 shadow-sm transition-colors">{styles.icon}</div>
              <div>
                <h3 className="text-xs font-bold uppercase tracking-widest text-slate-400 dark:text-slate-500 mb-1">Status Oficial</h3>
                <p className={`text-2xl font-bold ${styles.text} tracking-tight`}>{styles.title}</p>
                {status === 'warning' && <p className="text-xs text-amber-600 dark:text-amber-400 font-bold mt-1 bg-amber-100 dark:bg-amber-900/30 px-2 py-0.5 rounded inline-block">Renove agora</p>}
              </div>
            </div>
            <div className="flex flex-col items-center w-full md:w-auto bg-white/60 dark:bg-slate-800/60 p-4 rounded-xl border border-slate-100/50 dark:border-slate-700/50 backdrop-blur-sm transition-colors">
              <div className="flex items-end gap-2">
                 <span className={`text-5xl font-bold font-mono tracking-tighter leading-none ${styles.text}`}>{Math.max(0, daysRemaining)}</span>
                 <span className="text-xs font-bold uppercase text-slate-400 dark:text-slate-500 mb-1.5 pb-0.5">Dias<br/>Restantes</span>
              </div>
            </div>
          </div>
          <div className="mt-8">
            <div className="flex justify-between text-xs font-medium text-slate-500 dark:text-slate-400 mb-2">
              <span>Início: {serviceDate.toLocaleDateString()}</span>
              <span>Vencimento: {expirationDate.toLocaleDateString()}</span>
            </div>
            <div className="h-3 w-full bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden shadow-inner">
              <div className={`h-full ${styles.bar} transition-all duration-1000 ease-out`} style={{ width: `${progress}%` }}></div>
            </div>
          </div>
        </div>
      );
    };

    const Lightbox = ({ images, initialIndex, isOpen, onClose }) => {
      const [currentIndex, setCurrentIndex] = useState(initialIndex);
      const [isZoomed, setIsZoomed] = useState(false);

      useEffect(() => { setCurrentIndex(initialIndex); setIsZoomed(false); }, [initialIndex]);

      if (!isOpen) return null;

      const nav = (dir) => (e) => {
        e.stopPropagation();
        setIsZoomed(false);
        setCurrentIndex(prev => dir === 'next' 
          ? (prev === images.length - 1 ? 0 : prev + 1) 
          : (prev === 0 ? images.length - 1 : prev - 1));
      };

      return (
        <div className="fixed inset-0 z-50 bg-slate-950/95 backdrop-blur-md flex flex-col animate-fade-in">
          <div className="absolute top-0 left-0 right-0 p-4 flex justify-between items-center z-50 pointer-events-none">
            <div className="text-white/80 font-mono text-sm pointer-events-auto bg-black/40 px-3 py-1 rounded-full backdrop-blur-sm border border-white/10">{currentIndex + 1} / {images.length}</div>
            <button onClick={onClose} className="p-2 text-white/70 hover:text-white rounded-full pointer-events-auto"><Icons.X size={32}/></button>
          </div>
          <div className={`flex-1 flex items-center justify-center w-full h-full relative ${isZoomed ? 'overflow-auto cursor-zoom-out' : 'overflow-hidden cursor-zoom-in'}`} onClick={() => setIsZoomed(!isZoomed)}>
            <img src={images[currentIndex]} className={`transition-all duration-300 ${isZoomed ? 'min-w-[150%]' : 'max-h-full p-4 object-contain'}`}/>
            {!isZoomed && <>
              <button onClick={nav('prev')} className="absolute left-4 p-3 text-white/70 hover:bg-white/10 rounded-full hidden md:block"><Icons.ChevronLeft size={40}/></button>
              <button onClick={nav('next')} className="absolute right-4 p-3 text-white/70 hover:bg-white/10 rounded-full hidden md:block"><Icons.ChevronRight size={40}/></button>
            </>}
          </div>
          <div className="absolute bottom-6 left-1/2 -translate-x-1/2 z-50 pointer-events-none">
            <div className="bg-slate-900/80 text-slate-200 px-5 py-2.5 rounded-full text-sm font-medium backdrop-blur-md flex items-center gap-3 border border-white/10 shadow-xl pointer-events-auto">
              {isZoomed ? <><Icons.ZoomOut size={18} /><span>Reduzir</span></> : <><Icons.ZoomIn size={18} /><span>Ampliar Detalhes</span></>}
            </div>
          </div>
        </div>
      );
    };

    const ReminderStatus = ({ emails, nextDate, serviceId, serviceDate, warrantyMonths, onDownload }) => {
      const [isSending, setIsSending] = useState(false);
      const [sentSuccess, setSentSuccess] = useState(false);
      const [lastSentTime, setLastSentTime] = useState(null);
      const isMounted = useRef(true);

      useEffect(() => { isMounted.current = true; return () => { isMounted.current = false; }; }, []);
      
      const generatedMessage = useMemo(() => {
        const expDate = new Date(serviceDate);
        expDate.setMonth(expDate.getMonth() + warrantyMonths);
        return `Assunto: Aviso de Garantia - Serviço ID: ${serviceId}\n\nOlá,\n\nLembrete automático TechMaintain.\nA garantia do serviço (ID: ${serviceId}) vencerá em ${expDate.toLocaleDateString('pt-BR')}.\n\nSituação: Garantia Ativa.\nVerifique o equipamento. Se notar anomalia, contate-nos.\n\nAtenciosamente,\nEquipe Técnica`;
      }, [serviceId, serviceDate, warrantyMonths]);

      const handleManualSend = async () => {
        if (sentSuccess) return; 
        setIsSending(true);

        // Dispara o download automático do relatório
        if (onDownload) {
             try { await onDownload(); } catch(e) { console.error("Erro download auto", e); }
        }

        setTimeout(() => {
          if (!isMounted.current) return;
          
          const subject = `Aviso de Garantia - Serviço ID: ${serviceId}`;
          const body = generatedMessage;
          const cc = "luizdanrley47@gmail.com";
          const mailtoLink = `mailto:${emails.join(',')}?cc=${cc}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
          
          const link = document.createElement('a');
          link.href = mailtoLink;
          link.click();
          
          setIsSending(false);
          setSentSuccess(true);
          setLastSentTime(new Date().toLocaleTimeString('pt-BR'));
          alert(`O aplicativo de e-mail foi aberto.\n\n⚠️ IMPORTANTE:\n\nDevido a restrições de segurança do navegador, o relatório baixado NÃO é anexado automaticamente.\n\nPor favor, ARRASTE ou ANEXE o arquivo de imagem que acabou de ser baixado para o e-mail antes de enviar.`);
        }, 2000);
      };

      return (
        <div className="bg-slate-900 dark:bg-slate-950 rounded-xl overflow-hidden border border-slate-700 dark:border-slate-800 shadow-2xl mt-8">
          <div className="bg-slate-950 dark:bg-black px-6 py-4 border-b border-slate-800 flex items-center justify-between">
            <div className="flex items-center gap-3"><div className="p-2 bg-tech-600/20 text-tech-400 rounded-lg"><Icons.Server size={20} /></div><div><h3 className="text-sm font-bold text-white uppercase tracking-wider">Painel de Automação</h3><p className="text-xs text-slate-500 font-mono">Service Daemon v2.4.1</p></div></div>
            <div className="flex items-center gap-2 px-3 py-1 bg-emerald-500/10 border border-emerald-500/20 rounded-full"><Icons.Activity size={12} className="text-emerald-500 animate-pulse" /><span className="text-xs font-bold text-emerald-500 uppercase">Online</span></div>
          </div>
          <div className="p-6 grid md:grid-cols-2 gap-8">
            <div className="space-y-6">
              <div>
                <h4 className="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2"><Icons.MailCheck size={14} /> Destinatários</h4>
                <div className="bg-slate-800/50 dark:bg-slate-900/50 rounded-lg border border-slate-700 divide-y divide-slate-700/50">
                  {emails.map((email, idx) => (
                    <div key={idx} className="px-4 py-3 flex items-center gap-3"><div className="w-2 h-2 rounded-full bg-tech-500 shadow-[0_0_8px_rgba(14,165,233,0.5)]"></div><span className="text-sm text-slate-300 font-mono truncate">{email}</span></div>
                  ))}
                  <div className="px-4 py-3 flex items-center gap-3 bg-slate-900/50 dark:bg-black/50"><div className="w-2 h-2 rounded-full bg-purple-500"></div><span className="text-sm text-purple-300 font-mono truncate">CC: luizdanrley47@gmail.com</span></div>
                </div>
              </div>
              <div className="bg-slate-800/30 dark:bg-slate-900/30 rounded-lg p-4 border border-slate-700/50 flex justify-between">
                <div><p className="text-xs text-slate-400 uppercase font-bold mb-1">Próxima Verificação</p><p className="text-lg font-mono text-white font-bold flex items-center gap-2"><Icons.CalendarClock size={18} className="text-tech-500" />{nextDate}</p></div>
                <div className="text-right"><p className="text-xs text-slate-500">Intervalo</p><p className="text-sm text-slate-300 font-medium">30 Dias</p></div>
              </div>
            </div>
            <div>
              <div className="flex items-center justify-between mb-3"><h4 className="text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2"><Icons.Sparkles size={14} className="text-purple-400" /> Prévia</h4><button onClick={() => {navigator.clipboard.writeText(generatedMessage);alert("Copiado!");}} className="text-xs bg-slate-800 hover:bg-slate-700 text-slate-300 px-2 py-1 rounded border border-slate-700 flex gap-1"><Icons.Copy size={12} /> Copiar</button></div>
              <div className="bg-slate-950 dark:bg-black rounded-lg border border-slate-800 p-4 relative h-48 overflow-y-auto"><div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-purple-500 to-tech-500 opacity-50"></div><pre className="font-mono text-xs text-slate-400 whitespace-pre-wrap leading-relaxed">{generatedMessage}</pre></div>
            </div>
          </div>
          <div className="bg-slate-950/50 dark:bg-black/50 border-t border-slate-800 px-6 py-4 flex flex-col sm:flex-row items-center justify-between gap-4">
            <div className="flex items-center gap-3">
              {sentSuccess ? <div className="p-2 bg-emerald-500/10 text-emerald-500 rounded-full"><Icons.CheckCircle2 size={20} /></div> : <div className="p-2 bg-slate-800 text-slate-500 rounded-full"><Icons.MailCheck size={20} /></div>}
              <div><p className="text-sm font-bold text-slate-200">{sentSuccess ? 'E-mail Aberto' : 'Pendente'}</p><p className="text-xs text-slate-500">{sentSuccess ? `Disparado às ${lastSentTime}` : 'Aguardando ação'}</p></div>
            </div>
            <button onClick={handleManualSend} disabled={isSending || sentSuccess} className={`flex items-center gap-2 px-6 py-2.5 rounded-lg text-sm font-bold transition-all ${sentSuccess ? 'bg-emerald-600/20 text-emerald-500 border border-emerald-600/30' : 'bg-tech-600 hover:bg-tech-500 text-white shadow-lg border border-tech-500'} disabled:opacity-50`}>
              {isSending ? <><Icons.Loader2 size={16} className="animate-spin" />Preparando...</> : sentSuccess ? <><Icons.CheckCircle2 size={16} />Concluído</> : <><Icons.Send size={16} />Enviar Email Agora</>}
            </button>
          </div>
        </div>
      );
    };

    const QrModal = ({ isOpen, onClose }) => {
      if (!isOpen) return null;
      const url = "https://ai.studio/apps/drive/1eI-muCQOZsa0GDMhNmoPzZftWbg5ZAez?fullscreenApplet=true";
      const qr = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent(url)}`;
      return (
        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-fade-in">
          <div className="bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden border dark:border-slate-800 transition-colors">
            <div className="p-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50/50 dark:bg-slate-800/50">
              <h3 className="font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2"><Icons.QrCode size={18} className="text-tech-600 dark:text-tech-400" /> Acesso Mobile</h3>
              <button onClick={onClose} className="p-1 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-full text-slate-500 dark:text-slate-400"><Icons.X size={20} /></button>
            </div>
            <div className="p-8 flex flex-col items-center gap-6">
              <div className="bg-white p-2 rounded-xl border border-slate-200 shadow-sm"><img src={qr} alt="QR" className="w-48 h-48" /></div>
              <div className="text-center space-y-1"><p className="font-medium text-slate-800 dark:text-slate-200">Escaneie para abrir</p><p className="text-xs text-slate-500 dark:text-slate-400">Acesse o relatório completo.</p></div>
            </div>
          </div>
        </div>
      );
    };

    const App = () => {
      const [lightboxOpen, setLightboxOpen] = useState(false);
      const [qrOpen, setQrOpen] = useState(false);
      const [imgIndex, setImgIndex] = useState(0);
      const [loadingPdf, setLoadingPdf] = useState(false);
      const [isDark, setIsDark] = useState(false);

      useEffect(() => {
        if (isDark) document.documentElement.classList.add('dark');
        else document.documentElement.classList.remove('dark');
      }, [isDark]);

      const downloadImg = async () => {
        const el = document.getElementById('report-content');
        if(!el) return;
        setLoadingPdf(true);
        try {
          const canvas = await html2canvas(el, { 
            scale: 3, 
            useCORS: true, 
            allowTaint: true,
            backgroundColor: isDark ? '#020617' : '#f8fafc', 
            windowWidth: 1200,
            ignoreElements: (el) => el.classList.contains('no-print')
          });
          const link = document.createElement('a');
          link.download = `Relatorio-${serviceInfo.id}.png`; 
          link.href = canvas.toDataURL('image/png');
          link.click();
        } catch(e) { alert("Aviso: Bloqueio de segurança em algumas imagens externas."); }
        setLoadingPdf(false);
      };

      // Tratamento de erro de imagem
      const handleImageError = (e) => {
        const img = e.currentTarget;
        if (img.dataset.retry === 'true') {
           img.src = "https://placehold.co/400x400?text=Indisponivel";
           return;
        }
        if (img.src.includes('wsrv.nl')) {
          const originalUrl = img.src.split('?url=')[1];
          if (originalUrl) {
             img.dataset.retry = 'true';
             img.src = decodeURIComponent(originalUrl);
             img.removeAttribute('crossorigin');
          }
        }
      };

      const nextReminder = new Date(); nextReminder.setDate(new Date().getDate() + 30);

      return (
        <div className="min-h-screen bg-slate-50 dark:bg-slate-950 pb-20 font-sans transition-colors duration-300">
          <Lightbox images={GALLERY_IMAGES} isOpen={lightboxOpen} initialIndex={imgIndex} onClose={() => setLightboxOpen(false)} />
          <QrModal isOpen={qrOpen} onClose={() => setQrOpen(false)} />

          <header className="bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 sticky top-0 z-30 shadow-sm backdrop-blur-md bg-opacity-90 dark:bg-opacity-90 transition-colors no-print">
            <div className="max-w-5xl mx-auto px-4 py-4 flex flex-col md:flex-row md:items-center justify-between gap-4">
              <div>
                <div className="flex flex-col md:items-start gap-1 mb-2">
                   <div className="flex items-center gap-3 text-xs font-medium text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-800 px-2 py-1 rounded border border-slate-100 dark:border-slate-700 transition-colors">
                      <span className="flex items-center gap-1"><Icons.Calendar size={12} className="text-tech-600 dark:text-tech-400"/> {serviceInfo.date}</span>
                      <span className="w-px h-3 bg-slate-300 dark:bg-slate-600"></span>
                      <span className="flex items-center gap-1"><Icons.MapPin size={12} className="text-tech-600 dark:text-tech-400"/> {serviceInfo.location}</span>
                   </div>
                </div>
                <h1 className="text-xl md:text-2xl font-bold text-slate-900 dark:text-white flex items-center gap-2"><Icons.Award className="text-tech-600 dark:text-tech-400"/>Relatório de Manutenção</h1>
                <p className="text-xs text-slate-500 dark:text-slate-400 font-mono mt-1 tracking-wide uppercase">ID: {serviceInfo.id}</p>
              </div>
              
              <div className="flex gap-2">
                <button onClick={() => setIsDark(!isDark)} className="flex items-center justify-center bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 w-10 h-9 rounded-lg shadow-sm hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 transition-colors">{isDark ? <Icons.Sun size={18} /> : <Icons.Moon size={18} />}</button>
                <button onClick={() => setQrOpen(true)} className="flex items-center justify-center bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 w-10 h-9 rounded-lg shadow-sm hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 transition-colors"><Icons.QrCode size={18} /></button>
                <button onClick={downloadImg} disabled={loadingPdf} className="flex items-center gap-2 bg-tech-600 hover:bg-tech-700 dark:bg-tech-700 dark:hover:bg-tech-600 text-white px-4 py-2 rounded-lg text-sm font-medium shadow-sm disabled:opacity-50 transition-colors">
                  <Icons.Download size={16} /><span>{loadingPdf ? '...' : 'Baixar (IMG)'}</span>
                </button>
              </div>
            </div>
          </header>

          <main id="report-content" className="max-w-5xl mx-auto px-4 py-8 space-y-6 bg-slate-50 dark:bg-slate-950 transition-colors">
            <div className="grid md:grid-cols-2 gap-6">
              <Section title="Técnico Responsável" icon={<Icons.User />}>
                <div className="flex items-start gap-5">
                  <img src={getCorsProxyUrl(provider.avatarUrl)} crossOrigin="anonymous" onError={handleImageError} className="w-24 h-24 rounded-2xl object-cover border-2 border-slate-100 dark:border-slate-700 shadow-sm"/>
                  <div className="space-y-1.5">
                    <h3 className="font-bold text-slate-900 dark:text-white text-lg">{provider.name}</h3>
                    <div className="flex flex-wrap gap-1">{provider.roles.map(r=><span key={r} className="text-[10px] bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 px-2 py-0.5 rounded border border-slate-200 dark:border-slate-700">{r}</span>)}</div>
                    <div className="pt-3 space-y-1.5 text-sm text-slate-600 dark:text-slate-400">
                      <div className="flex items-center gap-2"><Icons.Mail size={14} className="text-tech-500" />{provider.email}</div>
                      <div className="flex items-center gap-2"><Icons.Smartphone size={14} className="text-tech-500" /><a href={getWhatsAppUrl(provider.whatsapp)} target="_blank" className="text-tech-600 dark:text-tech-400 underline">{provider.whatsapp} <Icons.ExternalLink size={10} className="inline"/></a></div>
                    </div>
                  </div>
                </div>
              </Section>
              <Section title="Informações do Cliente" icon={<Icons.User />}>
                <div className="flex items-start gap-5">
                  <div className="w-24 h-24 rounded-2xl bg-tech-50 dark:bg-tech-900/20 border-2 border-slate-100 dark:border-slate-800 flex items-center justify-center text-tech-600 dark:text-tech-400 font-bold text-3xl shadow-sm">{client.name[0]}</div>
                  <div className="space-y-1.5">
                    <h3 className="font-bold text-slate-900 dark:text-white text-lg">{client.name}</h3>
                    <span className="text-[10px] bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 px-2 py-0.5 rounded border border-slate-200 dark:border-slate-700">Proprietário</span>
                    <div className="pt-3 flex items-center gap-2 text-sm text-slate-600 dark:text-slate-400"><Icons.Smartphone size={14} className="text-tech-500" /><a href={getWhatsAppUrl(client.whatsapp)} target="_blank" className="text-tech-600 dark:text-tech-400 underline">{client.whatsapp} <Icons.ExternalLink size={10} className="inline"/></a></div>
                  </div>
                </div>
              </Section>
            </div>

            <div className="grid lg:grid-cols-3 gap-6">
              <Section title="Especificações" icon={<Icons.Cpu />} className="lg:col-span-2">
                <div className="grid sm:grid-cols-2 gap-x-12 gap-y-1">
                  <InfoRow label="Marca" value={device.brand} />
                  <InfoRow label="Modelo" value={device.model} mono />
                  <InfoRow label="Armazenamento" value={device.storage} />
                  <InfoRow label="Firmware" value={device.firmware} mono />
                  <InfoRow label="Modo" value={device.mode} />
                  <InfoRow label="Drive" value={device.drive} mono />
                </div>
                <div className="mt-5 pt-5 border-t border-slate-100 dark:border-slate-800">
                  <h4 className="text-xs font-bold text-slate-400 dark:text-slate-500 uppercase mb-3 flex items-center gap-2"><Icons.Wrench size={12} /> Acessórios</h4>
                  <div className="bg-slate-50 dark:bg-slate-800/50 p-3 rounded-lg border border-slate-100 dark:border-slate-800 text-sm text-slate-700 dark:text-slate-300 flex flex-wrap gap-2">
                     {device.cables.split(',').map((item, i) => (<span key={i} className="bg-white dark:bg-slate-800 px-2 py-1 rounded border border-slate-200 dark:border-slate-700 shadow-sm">{item.trim()}</span>))}
                     <span className="bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-300 px-2 py-1 rounded border border-emerald-100 dark:border-emerald-900/30 shadow-sm">{device.adapter}</span>
                  </div>
                </div>
              </Section>
              <Section title="Componentes" icon={<Icons.AlertTriangle />}>
                <div className="space-y-6 pt-2">
                  <div className="space-y-2">
                     <div className="flex justify-between items-center text-sm"><span className="font-medium text-slate-700 dark:text-slate-300">Integridade</span><span className="text-xs font-bold text-slate-400">80%</span></div>
                     <div className="w-full bg-slate-100 dark:bg-slate-800 rounded-full h-2"><div className="bg-emerald-500 h-2 rounded-full" style={{ width: '80%' }}></div></div>
                  </div>
                  <div className="grid gap-3">
                    <div className="p-3 bg-emerald-50/50 dark:bg-emerald-900/10 rounded-lg border border-emerald-100 dark:border-emerald-900/30"><div className="flex items-center justify-between mb-1"><span className="text-sm font-medium text-slate-700 dark:text-slate-200">Placa Mãe</span><Icons.CheckCircle2 size={16} className="text-emerald-500" /></div><p className="text-xs text-emerald-700 dark:text-emerald-400">Sem corrosão</p></div>
                    <div className="p-3 bg-tech-50/50 dark:bg-tech-900/10 rounded-lg border border-tech-100 dark:border-tech-900/30"><div className="flex items-center justify-between mb-1"><span className="text-sm font-medium text-slate-700 dark:text-slate-200">Carcaça</span><Icons.CheckCircle2 size={16} className="text-tech-500" /></div><p className="text-xs text-tech-700 dark:text-tech-400">Black Piano OK</p></div>
                  </div>
                </div>
              </Section>
            </div>

            <div className="grid md:grid-cols-2 gap-6">
              <Section title="Checklist" icon={<Icons.Wrench />}>
                <div className="space-y-5">
                  <div className="bg-white dark:bg-slate-900 rounded-xl border border-slate-100 dark:border-slate-800 divide-y divide-slate-50 dark:divide-slate-800 shadow-sm overflow-hidden">
                    {internalChecklist.map((item, idx) => (<div key={idx} className="flex items-center justify-between p-3"><span className="text-sm font-medium text-slate-700 dark:text-slate-300">{item.name}</span><StatusBadge status={item.status} /></div>))}
                  </div>
                </div>
              </Section>
              <Section title="Térmica" icon={<Icons.Thermometer />}>
                 <div className="flex items-center justify-between mb-6 bg-slate-50 dark:bg-slate-800/50 p-4 rounded-xl border border-slate-100 dark:border-slate-800">
                    <div><h3 className="text-lg font-bold text-slate-800 dark:text-white">{thermalSpecs.name}</h3><p className="text-xs text-slate-500 dark:text-slate-400">Alta Performance</p></div>
                    <div className="text-right"><span className="block text-3xl font-mono font-bold text-tech-600 dark:text-tech-400">{thermalSpecs.conductivity}</span><span className="text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase">W/mK</span></div>
                 </div>
                 <ThermalChart conductivity={thermalSpecs.conductivity} />
              </Section>
            </div>

            <Section title="Fotos" icon={<Icons.ImageIcon />}>
               <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 p-2">
                 {GALLERY_IMAGES.map((src, index) => (
                   <div key={index} className="group relative aspect-[4/3] bg-slate-100 dark:bg-slate-800 rounded-xl overflow-hidden shadow-sm cursor-pointer border border-slate-200 dark:border-slate-700 hover:border-tech-400 dark:hover:border-tech-500" onClick={() => { setImgIndex(index); setLightboxOpen(true); }}>
                     <img src={getCorsProxyUrl(src)} crossOrigin="anonymous" onError={handleImageError} className="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" loading="lazy"/>
                     <div className="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-all flex items-center justify-center"><div className="bg-white/20 p-3 rounded-full backdrop-blur-md"><Icons.ZoomIn className="text-white"/></div></div>
                   </div>
                 ))}
               </div>
            </Section>

            <section className="mt-12 space-y-6">
               <div className="flex items-center gap-3 px-2 mb-4"><div className="p-2 bg-tech-100 dark:bg-tech-900/30 rounded-lg text-tech-600 dark:text-tech-400"><Icons.Shield size={24}/></div><div><h2 className="text-xl font-bold text-slate-900 dark:text-white">Garantia</h2><p className="text-sm text-slate-500 dark:text-slate-400">Monitoramento em tempo real</p></div></div>
               <WarrantyCard serviceDate={SERVICE_DATE} durationMonths={WARRANTY_MONTHS} />
               <ReminderStatus 
                 emails={REMINDER_EMAILS} 
                 nextDate={nextReminder.toLocaleDateString('pt-BR')} 
                 serviceId={serviceInfo.id} 
                 serviceDate={SERVICE_DATE} 
                 warrantyMonths={WARRANTY_MONTHS} 
                 onDownload={downloadImg} 
               />
               
               <div className="flex flex-col items-center justify-center mt-16 mb-6 no-print">
                 <div className="relative px-8 py-4">
                    <p className="font-serif text-2xl italic text-slate-800 dark:text-slate-200 text-center relative z-10">Luiz Danrley Santos Silva</p>
                    <div className="absolute bottom-4 left-0 w-full h-px bg-slate-300 dark:bg-slate-700"></div>
                 </div>
                 <p className="text-[10px] uppercase tracking-widest text-slate-500 dark:text-slate-400 font-bold mt-1">Assinado Digitalmente - Responsável Técnico</p>
                 <p className="text-[10px] text-emerald-600 dark:text-emerald-400 font-medium mt-1 flex items-center gap-1">
                   <Icons.CheckCircle2 size={10} /> Documento Válido para Garantia
                 </p>
               </div>

               <div className="text-center pb-8 border-t border-slate-200 dark:border-slate-800 pt-8">
                 <p className="text-xs text-slate-400 dark:text-slate-500">TechMaintain System Secure Report</p>
               </div>
            </section>
          </main>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>